<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>座席登録（生徒用）</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
    }
    .seat-grid {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      gap: 8px;
      max-width: 600px;
      margin: auto;
      margin-top: 20px;
    }
    .seat {
      border: 1px solid #aaa;
      padding: 10px;
      height: 60px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      background-color: #f5f5f5;
      font-size: 14px;
      cursor: pointer;
    }
    .empty {
      background-color: #ddd;
      color: #999;
      cursor: default;
    }
    .highlight {
      background-color: #d0f0d0;
    }
  </style>
</head>
<body>
  <h1>座席登録（生徒用）</h1>
  <div class="seat-grid" id="seat-grid"></div>

  <script>
    const seatLayout = [
      null, null, 1, 2, 3, null,
      4, 5, 6, 7, 8, 9,
      10, 11, 12, 13, 14, 15,
      16, 17, 18, 19, 20, 21,
      22, 23, 24, 25, 26, 27,
      28, 29, 30, 31, 32, 33,
      34, 35, 36, 37, 38, null
    ];

    async function fetchSeats() {
      const response = await fetch('https://your-render-app.onrender.com/api/seats');
      const seats = await response.json();
      const grid = document.getElementById('seat-grid');
      grid.innerHTML = '';
      seatLayout.forEach(num => {
        const div = document.createElement('div');
        div.className = 'seat';
        if (num === null) {
          div.classList.add('empty');
          div.textContent = '[ 空席 ]';
        } else {
          const info = seats.find(s => s.seat === String(num));
          div.innerHTML = `<strong>${num}番</strong><br>${info ? info.name + ' (' + info.number + ')' : '空席'}`;
          if (!info) {
            div.onclick = () => {
              const name = prompt("名前を入力してください");
              const number = prompt("出席番号を入力してください");
              if (name && number) {
                fetch('https://your-render-app.onrender.com/api/seats', {
                  method: 'POST',
                  headers: { 'Content-Type': 'application/json' },
                  body: JSON.stringify({ seat: String(num), name, number })
                }).then(fetchSeats);
              }
            };
          } else {
            div.classList.add('highlight');
          }
        }
        grid.appendChild(div);
      });
    }

    fetchSeats();
    setInterval(fetchSeats, 5000); // 5秒ごとに更新
  </script>
</body>
</html>
